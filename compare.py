from matplotlib import pyplot as plt
import numpy as np

data_0_01 = [1.5391914719810011, 1.5547958123125094, 1.554812938257353, 1.5548300641368673, 1.5548471899509477, 1.554864315699491, 1.5548814413823913, 1.5548985669995454, 1.554915692550849, 1.5549328180361979, 1.5549499434554879, 1.5549670688086157, 1.5549841940954772, 1.5550013193159686, 1.5550184444699857, 1.5550355695574258, 1.5550526945781846, 1.5550698195321584, 1.555086944419244, 1.5551040692393383, 1.5551211939923373, 1.555138318678139, 1.5551554432966386, 1.5551725678477335, 1.5551896923313209, 1.5552068167472977, 1.5552239410955608, 1.5552410653760074, 1.5552581895885345, 1.55527531373304, 1.55529243780942, 1.5553095618175727, 1.5553266857573953, 1.5553438096287855, 1.5553609334316412, 1.5553780571658589, 1.5553951808313375, 1.5554123044279744, 1.5554294279556664, 1.5554465514143132, 1.555463674803811, 1.555480798124059, 1.5554979213749551, 1.555515044556397, 1.555532167668283, 1.5555492907105113, 1.555566413682981, 1.5555835365855895, 1.5556006594182363, 1.5556177821808193, 1.5556349048732367]
data_0_025 = [1.5391914719810011, 1.554821498644896, 1.5548643105783877, 1.554907122101284, 1.554949933211959, 1.554992743908786, 1.5550355541901433, 1.55507836405441, 1.5551211734999684, 1.5551639825252033, 1.555206791128502, 1.5552495993082547, 1.5552924070628538, 1.5553352143906933, 1.5553780212901713, 1.5554208277596882, 1.5554636337976457, 1.5555064394024491, 1.555549244572506, 1.5555920493062267, 1.5556348536020237, 1.5556776574583124, 1.5557204608735105, 1.5557632638460381, 1.5558060663743185, 1.5558488684567764, 1.5558916700918404, 1.5559344712779413, 1.5559772720135119, 1.5560200722969877, 1.5560628721268073, 1.556105671501411, 1.556148470419243, 1.5561912688787487, 1.556234066878377, 1.5562768644165783, 1.5563196614918076, 1.5563624581025202, 1.5564052542471747, 1.5564480499242335, 1.5564908451321604, 1.5565336398694214, 1.5565764341344868, 1.5566192279258273, 1.5566620212419178, 1.5567048140812358, 1.55674760644226, 1.5567903983234737, 1.5568331897233605, 1.556875980640409, 1.5569187710731085]
data_0_05 = [1.5391914719810011, 1.5548642923071745, 1.554949896664836, 1.555035499362393, 1.5551211003868528, 1.555206699725264, 1.5552922973647152, 1.555377893292335, 1.5554634874952917, 1.5555490799607958, 1.5556346706760973, 1.5557202596284863, 1.5558058468052949, 1.5558914321938944, 1.5559770157816992, 1.5560625975561624, 1.556148177504779, 1.5562337556150847, 1.5563193318746573, 1.5564049062711145, 1.5564904787921159, 1.556576049425362, 1.5566616181585948, 1.5567471849795982, 1.5568327498761971, 1.556918312836258, 1.5570038738476888, 1.5570894328984397, 1.557174989976502, 1.557260545069909, 1.5573460981667355, 1.5574316492550988, 1.5575171983231575, 1.557602745359113, 1.5576882903512081, 1.5577738332877273, 1.5578593741569986, 1.5579449129473906, 1.5580304496473152, 1.5581159842452266, 1.5582015167296208, 1.5582870470890362, 1.558372575312054, 1.558458101387298, 1.5585436253034342, 1.5586291470491704, 1.5587146666132594, 1.5588001839844932, 1.55888569915171, 1.558971212103788, 1.5590567228296495]
data_rk_0_05 = [1.5391914719810011, 1.5548600131823282, 1.5549413385766022, 1.5550226624740888, 1.555103984863645, 1.5551853057341618, 1.5552666250745617, 1.5553479428738015, 1.55542925912087, 1.555510573804789, 1.555591886914614, 1.5556731984394319, 1.555754508368365, 1.555835816690567, 1.5559171233952258, 1.5559984284715622, 1.5560797319088304, 1.5561610336963176, 1.5562423338233458, 1.5563236322792684, 1.5564049290534743, 1.5564862241353843, 1.5565675175144544, 1.5566488091801733, 1.5567300991220638, 1.5568113873296825, 1.5568926737926196, 1.5569739585004994, 1.5570552414429797, 1.5571365226097529, 1.5572178019905447, 1.5572990795751163, 1.5573803553532606, 1.557461629314807, 1.5575429014496174, 1.557624171747589, 1.5577054401986525, 1.5577867067927738, 1.557867971519952, 1.5579492343702215, 1.5580304953336503, 1.5581117544003424, 1.558193011560434, 1.5582742668040979, 1.5583555201215404, 1.558436771503002, 1.5585180209387595, 1.5585992684191223, 1.5586805139344366, 1.5587617574750816, 1.5588429990314716]
data_rk_0_01 = [1.5391914719810011, 1.5547956410546564, 1.554812595742946, 1.554829550367209, 1.5548465049273428, 1.5548634594232476, 1.5548804138548213, 1.5548973682219633, 1.5549143225245723, 1.5549312767625478, 1.5549482309357885, 1.5549651850441935, 1.554982139087662, 1.5549990930660933, 1.5550160469793874, 1.5550330008274427, 1.5550499546101595, 1.5550669083274364, 1.5550838619791738, 1.5551008155652712, 1.5551177690856282, 1.5551347225401444, 1.55515167592872, 1.5551686292512545, 1.5551855825076482, 1.555202535697801, 1.555219488821613, 1.5552364418789844, 1.5552533948698153, 1.555270347794006, 1.5552873006514567, 1.5553042534420682, 1.5553212061657404, 1.5553381588223747, 1.5553551114118709, 1.5553720639341297, 1.5553890163890518, 1.5554059687765385, 1.55542292109649, 1.5554398733488077, 1.5554568255333925, 1.5554737776501448, 1.5554907296989662, 1.5555076816797584, 1.555524633592421, 1.5555415854368568, 1.555558537212967, 1.5555754889206523, 1.5555924405598147, 1.5556093921303549, 1.5556263436321751]
data_second_0_05 = [1.5391914719810011, 1.5548642923071745, 1.554949896664836, 1.555035499362393, 1.5551211003868528, 1.555206699725264, 1.5552922973647152, 1.555377893292335, 1.5554634874952917, 1.5555490799607958, 1.5556346706760973, 1.5557202596284863, 1.5558058468052949, 1.5558914321938944, 1.5559770157816992, 1.5560625975561624, 1.556148177504779, 1.5562337556150847, 1.5563193318746573, 1.5564049062711145, 1.5564904787921159, 1.556576049425362, 1.5566616181585948, 1.5567471849795982, 1.5568327498761971, 1.556918312836258, 1.5570038738476888, 1.5570894328984397, 1.557174989976502, 1.557260545069909, 1.5573460981667355, 1.5574316492550988, 1.5575171983231575, 1.5576027453591132, 1.5576882903512081, 1.5577738332877273, 1.5578593741569986, 1.5579449129473906, 1.5580304496473152, 1.5581159842452266, 1.5582015167296208, 1.5582870470890362, 1.558372575312054, 1.558458101387298, 1.5585436253034342, 1.5586291470491704, 1.5587146666132594, 1.5588001839844934, 1.55888569915171, 1.558971212103788, 1.5590567228296495]
data_third_0_05_0_inter = [1.5391914719810011, 1.5548642923071745, 1.55500310248666, 1.5550974065584229, 1.5552414684053608, 1.555302220440093, 1.5554079812517105, 1.5554513969402082, 1.5555371494792622, 1.5555852718926597, 1.5556756377213388, 1.5558309542390214, 1.5559083568564303, 1.556026582636502, 1.5560783918996584, 1.5561469362471243, 1.556244858278884, 1.5563255839567278, 1.5563981139596632, 1.5565247278271443, 1.5566250426382588, 1.5566967425407017, 1.5568046443062968, 1.5568763920379285, 1.5569567532441944, 1.5570895678301078, 1.5571639549425433, 1.5572575837415843, 1.5573193960319347, 1.5573860295566178, 1.5574468986082608, 1.5575120355084242, 1.5576293973882365, 1.5577075805152147, 1.5578054284881793, 1.557888125769063, 1.5580140050152569, 1.5580591472167586, 1.5581803203859617, 1.5582761889527565, 1.5583323118758339, 1.5583971828954932, 1.558466470125468, 1.558582599182851, 1.5586630809158397, 1.5587606043660172, 1.5588400288462374, 1.5589292573749045, 1.5590041091538278, 1.559092702699654, 1.5591855132470573]
data_third_0_05_1_inter = [1.5391914719810011, 1.5548642923071745, 1.5549298472884214, 1.5550521348741504, 1.5551345403860901, 1.555241934374124, 1.5553078900134063, 1.5553995040996706, 1.5554485190033018, 1.555515283597121, 1.5555421474842184, 1.5556081974346374, 1.555715559984326, 1.5557939974549944, 1.5558844239892031, 1.5559607867049579, 1.5560204296787954, 1.5561445230358417, 1.556198940061833, 1.556315489270291, 1.5563964102462595, 1.556453287733255, 1.556557783492373, 1.5566472956154418, 1.5567335247403813, 1.5567895493005515, 1.5569079407848154, 1.557017151187544, 1.5571340655554526, 1.557239322390895, 1.5573290619681257, 1.5573961389682505, 1.557510926128199, 1.5575535595786199, 1.5576471511661019, 1.5577212837275032, 1.5577860180469376, 1.557919617762259, 1.5579601789116158, 1.5580487832310137, 1.5581499718756568, 1.5582698258261833, 1.5583433655501064, 1.558446086781112, 1.5585090599319056, 1.5586095703723442, 1.5587199531954494, 1.5588112207169753, 1.5589115516701093, 1.5589904873475044, 1.5590740259456712]
data_third_0_05_2_inter = [1.5391914719810011, 1.5548642923071745, 1.5549291245773709, 1.5550505623540147, 1.5551319827847607, 1.5552382613811249, 1.5553029493833557, 1.5553930323809744, 1.55544031433335, 1.5555051917813247, 1.5555299040364867, 1.5555936073433423, 1.5556984280397679, 1.5557738905000051, 1.555860471411282, 1.5559317786334381, 1.5559854802272146, 1.5561024074944327, 1.5561342350086733, 1.556248925169382, 1.556344931877442, 1.556409089802603, 1.5565195092490414, 1.5566139912782186, 1.5567038652494285, 1.556762678859919, 1.5568835741062905, 1.556994901742849, 1.5571137479983368, 1.557220662778887, 1.5573117570812651, 1.557369042895169, 1.5574851282340656, 1.5575288952992428, 1.5576234800333542, 1.5576984469098754, 1.5577638589354257, 1.5578811141643034, 1.5579212153601985, 1.5580091480216913, 1.5581093723552626, 1.5582278437308905, 1.558298642411498, 1.5584048573474016, 1.5584686909041536, 1.5585689065447252, 1.5586781753632812, 1.5587674992549054, 1.5588623955384922, 1.5589492125034874, 1.5590671989570246]
# data_third_0_05_2_inter_full = [3.826433158962024, 3.826198127379086, 3.826210314436866, 3.8262203998864277, 3.826231056282672, 3.8262410766864754, 3.8262520886972538, 3.826262617294047, 3.8262729831600164, 3.8262834636495233, 3.826294051881294, 3.826305001142457, 3.82631500244556, 3.826325754941202, 3.826336171059899, 3.8263468125454567, 3.826357265080326, 3.826368312114136, 3.826378250531269, 3.826388864434076, 3.82639947836634, 3.8264100866558435, 3.826420500790257, 3.8264308569161716, 3.8264414253169035, 3.8264518990017975, 3.8264624070575497, 3.8264723620705, 3.826482642522743, 3.8264930476084884, 3.826503388590297, 3.826513575126717, 3.82652421180366, 3.8265346952124752, 3.8265450053422945, 3.8265554610357886, 3.8265662321923037, 3.82657668982649, 3.826587348140661, 3.8265972709662543, 3.8266078122535716, 3.8266178591127056, 3.826628407274865, 3.826638634956103, 3.826649145644016, 3.82665953104061, 3.8266698928346234, 3.826680585844904, 3.826690776916312, 3.8267013437224837, 3.82671162593941]
# data_third_0_05_2_inter_full_cr = [1.5391914719810011, 1.5390969299903074, 1.5391018322621162, 1.5391058891572225, 1.5391101757169348, 1.539114206447236, 1.5391186360537064, 1.5391228712057978, 1.539127040899044, 1.53913125669987, 1.539135515840267, 1.5391399202055613, 1.5391439432525627, 1.5391482684684772, 1.5391524583759975, 1.5391567389378522, 1.5391609434938611, 1.5391653871884259, 1.5391693849394021, 1.5391736544060324, 1.5391779238845118, 1.5391821910931778, 1.5391863802025156, 1.5391905459778026, 1.539194797141119, 1.539199010204774, 1.5392032370941846, 1.5392072415208664, 1.5392113768562456, 1.5392155623257364, 1.539219722009272, 1.539223819566798, 1.5392280981943762, 1.5392323151695002, 1.539236462442753, 1.539240668269326, 1.539245000991619, 1.53924920759884, 1.539253494930043, 1.5392574864092865, 1.5392617266661703, 1.5392657680381887, 1.5392700110604933, 1.5392741251686157, 1.5392783531168195, 1.5392825306663038, 1.5392866987215965, 1.5392910000093882, 1.5392950993911234, 1.5392993499130245, 1.5393034859582522]


render_borders = [20, 499]

plt.rcParams["figure.figsize"] = [6, 4]
plt.rcParams["figure.autolayout"] = True

x = np.linspace(render_borders[0], render_borders[1], len(data_0_01)-2)

plt.plot(x, data_0_01[2:], color='red', label='Эйлер, шаг 0.01')
plt.plot(x, data_0_025[2:], color='green', label='Эйлер, шаг 0.025')
plt.plot(x, data_0_05[2:], color='blue', label='Эйлер, шаг 0.05')

# plt.plot(x, data_rk_0_05[2:], color='red', label='Рунге-Кутта, шаг 0.05')
# plt.plot(x, data_0_05[2:], color='blue', label='Эйлер, шаг 0.05')

# plt.plot(x, data_0_05[2:], color='blue', label='Эйлер, шаг 0.05')
# plt.plot(x, data_second_0_05[2:], color='red', label='Эйлер через синус/косинус, шаг 0.05')


# plt.plot(x, data_0_05[2:], color='black', label='Эйлер через радиус, шаг 0.05')
# plt.plot(x, data_third_0_05_0_inter[2:], color='red', label='Через таблицу, интерполяция 0, шаг 0.05')
# plt.plot(x, data_third_0_05_1_inter[2:], color='blue', label='Через таблицу, интерполяция 1, шаг 0.05')
# plt.plot(x, data_third_0_05_2_inter[2:], color='green', label='Через таблицу, интерполяция 2, шаг 0.05')
# plt.plot(x, data_rk_0_05[2:], color='magenta', label='Рунге-Кутта, шаг 0.05')


#лчший-худший
# plt.plot(x, data_third_0_05_0_inter[2:], color='green', label='Через таблицу, интерполяция 0, шаг 0.05')
# plt.plot(x, data_rk_0_05[2:], color='blue', label='Рунге-Кутта, шаг 0.05')

# plt.plot(x, data_rk_0_05[2:], color='red', label='Рунге-Кутта, шаг 0.05')
# plt.plot(x, data_rk_0_01[2:], color='blue', label='Рунге-Кутта, шаг 0.01')
# plt.plot(x, data_0_01[2:], color='green', label='Эйлер, шаг 0.01')

print('Шаг Эйлера, 0.05, с 20го =', (data_0_05[-1] - data_0_05[2])/480)
print('Шаг Эйлера через синус/косинус, 0.05, с 20го =', (data_second_0_05[-1] - data_second_0_05[2])/480)
print('Шаг Эйлера, 0.01, с 20го =', (data_0_01[-1] - data_0_01[2])/480)
print('Шаг Рунге-Кутты, 0.05, с 20го =', (data_rk_0_05[-1] - data_rk_0_05[2])/480)
print('Шаг Рунге-Кутты, 0.01, с 20го =', (data_rk_0_01[-1] - data_rk_0_01[2])/480)

print()
print('Шаг Эйлера, 0.05, до 20го =', (data_0_05[2] - data_0_05[0])/20)
print('Шаг Эйлера через синус/косинус, 0.05, до 20го =', (data_second_0_05[2] - data_second_0_05[0])/20)
print('Шаг Эйлера, 0.01, до 20го =', (data_0_01[2] - data_0_01[0])/20)
print('Шаг Рунге-Кутты, 0.05, до 20го =', (data_rk_0_05[2] - data_rk_0_05[0])/20)
print('Шаг Рунге-Кутты, 0.01, до 20го =', (data_rk_0_01[2] - data_rk_0_01[0])/20)
print()

print('Шаг таблицы, 0.05, интерполяция 0, с 20го', (data_third_0_05_0_inter[-1] - data_third_0_05_0_inter[2])/480)
print('Шаг таблицы, 0.05, интерполяция 1, с 20го', (data_third_0_05_1_inter[-1] - data_third_0_05_1_inter[2])/480)
print('Шаг таблицы, 0.05, интерполяция 2, с 20го', (data_third_0_05_2_inter[-1] - data_third_0_05_2_inter[2])/480)
print()
print('Шаг таблицы, 0.05, интерполяция 0, до 20го', (data_third_0_05_0_inter[2] - data_third_0_05_0_inter[0])/20)
print('Шаг таблицы, 0.05, интерполяция 1, до 20го', (data_third_0_05_1_inter[2] - data_third_0_05_1_inter[0])/20)
print('Шаг таблицы, 0.05, интерполяция 2, до 20го', (data_third_0_05_2_inter[2] - data_third_0_05_2_inter[0])/20)


# print('data_rk_0_05[-1] - data_0_05[-1]', (data_0_05[-1] - data_rk_0_05[-1])/480)
# print('data_0_05[-1] - data_0_01[-1]', (data_0_05[-1] - data_0_01[-1])/480)
# print('data_0_05[-1] - data_second_0_05[-1]', data_0_05[-1] - data_second_0_05[-1])
# print('data_third_0_05_1_inter[-1] - data_third_0_05_0_inter[-1]', data_third_0_05_1_inter[-1] - data_third_0_05_0_inter[-1])
# print('data_third_0_05_2_inter[-1] - data_third_0_05_1_inter[-1]', data_third_0_05_2_inter[-1] - data_third_0_05_1_inter[-1])
# print('data_third_0_05_2_inter[-1] - data_third_0_05_0_inter[-1]', data_third_0_05_2_inter[-1] - data_third_0_05_0_inter[-1])
# print('data_third_0_05_0_inter[-1] - data_rk_0_05[-1]', data_third_0_05_0_inter[-1] - data_rk_0_05[-1])

plt.grid()
legend = plt.legend(loc='lower right')
plt.savefig('first_0.05_0.025_0.01.pdf')

plt.show()
